package goitop

import (
	"os"
	"testing"
)

func TestClient_GetAllExploitationService(t *testing.T) {

	c := NewClient(os.Getenv("GOITOP_ADDR"), os.Getenv("GOITOP_USER"), os.Getenv("GOITOP_PASSWORD"))
	services, err := c.GetAllExploitationService()
	if err != nil {
		t.Fatal(err)
	}

	if len(services) == 0 {
		t.Fatal("No Exploitation Service returned")
	}
}

func TestClient_GetExploitationService(t *testing.T) {

	c := NewClient(os.Getenv("GOITOP_ADDR"), os.Getenv("GOITOP_USER"), os.Getenv("GOITOP_PASSWORD"))
	id, err := c.GetExploitationService(os.Getenv("GOITOP_EXP_NAME"))
	if err != nil {
		t.Fatal(err)
	}

	if id != os.Getenv("GOITOP_EXP_ID") {
		t.Fatalf("GetExploitationService() got %s; want %s", id, os.Getenv("GOITOP_EXP_ID"))
	}
}
